<script>
    let currentMember = "Dharmendiran";
    let familyData = {
        "Dharmendiran": { cal: 0, sugar: 0, pro: 0, history: [] },
        "Father": { cal: 0, sugar: 0, pro: 0, history: [] },
        "Mother": { cal: 0, sugar: 0, pro: 0, history: [] }
    };

    // THIS IS THE BIG DATABASE - MAKE SURE THIS IS IN YOUR CODE
    const foodDb = {
        "idli": { cal: 65, sugar: 1, pro: 2, cat: "South Indian" },
        "dosa": { cal: 170, sugar: 1, pro: 4, cat: "South Indian" },
        "vada": { cal: 110, sugar: 0, pro: 3, cat: "South Indian" },
        "pongal": { cal: 212, sugar: 1, pro: 5, cat: "South Indian" },
        "biryani": { cal: 480, sugar: 2, pro: 18, cat: "South Indian" },
        "sambar rice": { cal: 320, sugar: 3, pro: 8, cat: "South Indian" },
        "curd rice": { cal: 200, sugar: 2, pro: 5, cat: "South Indian" },
        "parotta": { cal: 260, sugar: 2, pro: 5, cat: "South Indian" },
        "rasam": { cal: 60, sugar: 1, pro: 1, cat: "South Indian" },
        "filter coffee": { cal: 85, sugar: 12, pro: 2, cat: "Drink" },
        "upma": { cal: 190, sugar: 2, pro: 4, cat: "South Indian" },
        "appam": { cal: 120, sugar: 4, pro: 2, cat: "South Indian" },
        "pizza": { cal: 280, sugar: 5, pro: 10, cat: "Global" },
        "burger": { cal: 450, sugar: 8, pro: 15, cat: "Global" },
        "pasta": { cal: 320, sugar: 5, pro: 10, cat: "Global" },
        "samosa": { cal: 150, sugar: 1, pro: 3, cat: "Snack" },
        "soda": { cal: 150, sugar: 39, pro: 0, cat: "Drink" },
        "gulab jamun": { cal: 150, sugar: 25, pro: 2, cat: "Dessert" },
        "payasam": { cal: 250, sugar: 30, pro: 4, cat: "Dessert" },
        "apple": { cal: 52, sugar: 10, pro: 1, cat: "Fruit" },
        "egg": { cal: 70, sugar: 0, pro: 6, cat: "Protein" },
        "chicken": { cal: 230, sugar: 0, pro: 25, cat: "Protein" },
        "banana": { cal: 89, sugar: 12, pro: 1, cat: "Fruit" },
        "chapati": { cal: 70, sugar: 0, pro: 3, cat: "North Indian" },
        "dal": { cal: 150, sugar: 1, pro: 7, cat: "North Indian" }
    };

    function checkFood() {
        const input = document.getElementById('foodSearch').value.toLowerCase().trim();
        const res = document.getElementById('searchResult');
        
        // This checks if the word you typed exists in the big list above
        if(foodDb[input]) {
            const item = foodDb[input];
            res.innerHTML = `MATCH: [${item.cat}] ${input} (Calories: ${item.cal})`;
            res.style.color = "#00f3ff";
        } else {
            res.innerHTML = "Searching database...";
            res.style.color = "#666";
        }
    }

    function addIntake() {
        const field = document.getElementById('foodSearch');
        const food = field.value.toLowerCase().trim();
        
        if(foodDb[food]) {
            const item = foodDb[food];
            const m = familyData[currentMember];
            
            m.cal += item.cal;
            m.sugar += item.sugar;
            m.pro += item.pro;
            m.history.unshift(`${new Date().toLocaleTimeString()} - ${food} (+${item.sugar}g sugar)`);
            
            updateUI();
            field.value = "";
            document.getElementById('searchResult').innerText = "";
        } else {
            alert("Food not found! Try typing 'biryani' or 'idli'.");
        }
    }

    function selectMember(name, el) {
        currentMember = name;
        document.getElementById('memberName').innerText = "Profile: " + name;
        document.querySelectorAll('.member-card').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        updateUI();
    }

    function updateUI() {
        const m = familyData[currentMember];
        document.getElementById('calVal').innerText = m.cal;
        document.getElementById('sugarVal').innerText = m.sugar;
        document.getElementById('proVal').innerText = m.pro;
        document.getElementById('logHistory').innerHTML = m.history.join("<br>");

        const alertBanner = document.getElementById('healthAlert');
        const light = document.getElementById(`light-${currentMember}`);

        if (m.sugar > 40) {
            alertBanner.style.display = 'block';
            if(light) light.style.background = '#ff4444';
        } else {
            alertBanner.style.display = 'none';
            if(light) light.style.background = '#00ff88';
        }
    }
</script>
